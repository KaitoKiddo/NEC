# 医学图像分类模型

## 项目简介

这个项目实现了一个基于迁移学习的医学图像分类模型，专门用于处理灰度医学图像。由于医学图像数据集通常较小（如本项目假设约6000张图像），该模型利用预训练的深度学习模型（如在ImageNet上预训练的ResNet50）进行迁移学习，以提高在小数据集上的分类性能。

## 功能特点

- 支持灰度医学图像的处理和分类
- 利用迁移学习方法，基于预训练模型进行微调
- 提供完整的数据处理、模型训练和评估流程
- 支持使用PyTorch内置模型或Hugging Face模型
- 包含数据增强技术，提高模型泛化能力
- 自动保存最佳模型和训练历史记录

## 环境要求

项目依赖以下Python库：

```
torch>=1.7.0
torchvision>=0.8.0
transformers>=4.5.0
numpy>=1.19.0
scikit-learn>=0.24.0
matplotlib>=3.3.0
pillow>=8.0.0
pandas>=1.2.0
tqdm>=4.50.0
glob2>=0.7
```

## 安装方法

1. 克隆本仓库：
   ```bash
   git clone <仓库URL>
   cd NEC
   ```

2. 安装依赖：
   ```bash
   pip install -r requirements.txt
   ```

## 使用方法

### 1. 数据准备

使用`data_preparation.py`脚本处理和分析您的医学图像数据集：

```bash
python data_preparation.py
```

该脚本将：
- 扫描您的数据集目录
- 分析图像尺寸和类别分布
- 将数据集分割为训练集、验证集和测试集
- 生成数据集统计信息和可视化
- 可选择创建组织良好的数据集目录结构

### 2. 模型训练

使用`medical_image_classification.py`脚本训练模型：

```bash
python medical_image_classification.py
```

该脚本提供两种模型选择：
- PyTorch内置的预训练ResNet50模型
- Hugging Face提供的预训练模型

### 3. 自定义训练

要根据您的具体需求自定义训练过程，请修改`medical_image_classification.py`中的以下部分：

- 数据加载部分：指向您实际的医学图像数据
- 模型选择：可以选择不同的预训练模型架构
- 超参数设置：调整学习率、批量大小、训练轮数等
- 模型保存路径：指定模型保存的位置

## 项目结构

```
├── README.md                    # 项目说明文档
├── requirements.txt             # 项目依赖列表
├── medical_image_classification.py  # 主要的模型训练脚本
└── data_preparation.py          # 数据集处理和分析脚本
```

## 注意事项

- 该项目默认处理灰度医学图像，并将其转换为三通道输入以适应预训练模型
- 演示脚本使用随机生成的数据，实际使用时需替换为真实医学图像数据
- 为获得最佳性能，建议根据您的具体任务调整模型参数和数据预处理方法

## 未来改进

- 添加更多预训练模型选项
- 实现模型解释功能，提高医学应用的可解释性
- 添加交叉验证支持，提高模型评估的可靠性
- 优化模型以支持更多类型的医学图像